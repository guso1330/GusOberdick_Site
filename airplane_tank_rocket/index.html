<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title><!-- Space - Plane - Rockets --></title>
        <script src="//cdn.jsdelivr.net/phaser/2.4.4/phaser.js"></script>
    </head>
    <body>

        <div class="container">
            <div class="game">

                <script type="text/javascript">

                window.onload = function() {


                    // CONSTANTS
                    var WIDTH = 960;
                    var HEIGHT = 768;
                    var num_clouds = 6;
                    var plane;
                    var background;
                    var speedx = 14;
                    var speedy = 10;
                    // var rand_x = Math.floor(Math.random() * 2) - 1;
                    // var rand_y = Math.floor(Math.random() * 2) - 1;

                    // Initialize phaser
                    var game = new Phaser.Game(WIDTH, HEIGHT, Phaser.CANVAS, '', { preload: preload, create: create, update: update, render: render });

                    function preload () {

                        // Load background
                        game.load.image('background', 'assets/skybg.png');

                        // Load plane sprite
                        game.load.spritesheet('plane', 'assets/biplane_spritesheet.png', 32, 32, 6);

                        // loading cloud images
                        // for(i=1; i<=num_clouds; ++i)
                        // {
                        //     game.load.image('cloud'+i, 'assets/cloud_'+i+'.png');
                        // }

                        

                    }

                    function create () {



                        // Starting physics system
                        game.physics.startSystem(Phaser.Physics.ARCADE);
                        plane = game.add.sprite(0,0,'plane');
                        game.physics.enable(plane, Phaser.Physics.ARCADE);
                        plane.body.collideWorldBounds = true;

                        // Adding background
                        background = game.add.sprite(0,0,'background');

                        // Plane Animations
                        plane = game.add.sprite(WIDTH/2, HEIGHT-40, 'plane');
                        plane.anchor.setTo(0.5,0.5);
                        plane.animations.add('idle');
                        plane.animations.play('idle', 30, true);

                        game.physics.arcade.enable(plane);

                        // load clouds
                        var clouds = [];
                        for(i=1; i<=num_clouds; ++i)
                        {
                            game.add.sprite(-1*(Math.floor((Math.random() * 1024) + 1)), -1*(Math.floor((Math.random() * WIDTH) + 1)), 'cloud'+i);
                        }



                    }

                    function update() {

                        /////////////////////////////////////////////
                        //             Check COLLISIONS            // 
                        //CHECK FOR COLLISIONS WITH EDGES OF WINDOW//
                        /////////////////////////////////////////////
                        if (plane.x >= WIDTH)
                        {
                            plane.x = WIDTH;
                        }
                        if (plane.x <= 0)
                        {
                            plane.x = 0;
                        }
                        if (plane.y >= HEIGHT)
                        {
                            plane.y = HEIGHT;
                        }
                        if (plane.y <= 0)
                        {
                            plane.y = 0;
                        }

                        /////////////////////////////////////////////////////
                        //              CHECK ALL CONTROL                  //
                        /////////////////////////////////////////////////////
                        if(game.input.keyboard.isDown(Phaser.Keyboard.UP))
                            plane.y -= speedy;
                        if(game.input.keyboard.isDown(Phaser.Keyboard.DOWN))
                            plane.y += speedy;
                        if (game.input.keyboard.isDown(Phaser.Keyboard.LEFT))
                        {
                            plane.x -= speedx;
                            plane.angle = -15;
                        }
                        else if (game.input.keyboard.isDown(Phaser.Keyboard.RIGHT))
                        {
                            plane.x += speedx;
                            plane.angle = 15;
                        }
                        else
                            plane.rotation = 0;
                    }

                    function render() {
                        //debug helper
                        // game.debug.spriteInfo(plane,32,32);
                    }

                };

                </script>

            </div>
        </div>
    </body>
</html>